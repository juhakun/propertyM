package com.juliahaeusler.uebung13;

import java.awt.BorderLayout;
import java.awt.EventQueue;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.border.EmptyBorder;
import javax.swing.table.DefaultTableModel;

import net.miginfocom.swing.MigLayout;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;

public class Stundenplan extends JFrame {

    private JPanel contentPane;
    private JTable tableStundenplan;
    private DefaultTableModel stundenplanModel;
    private String dateiname = "." + File.separator + " stundenplan.dat";

    /**
     * Launch the application.
     */
    public static void main(String[] args) {
	EventQueue.invokeLater(new Runnable() {
	    public void run() {
		try {
		    Stundenplan frame = new Stundenplan();
		    frame.setVisible(true);
		} catch (Exception e) {
		    e.printStackTrace();
		}
	    }
	});
    }

    /**
     * Create the frame.
     */
    public Stundenplan() {
    	addWindowListener(new WindowAdapter() {
    		@Override
    		public void windowClosing(WindowEvent e) {
    		    try (var out = new BufferedWriter(new FileWriter(dateiname))) {
    			for (var i = 0; i < tableStundenplan.getModel().getRowCount(); i ++) {
    			    for (var j = 0; j < tableStundenplan.getModel().getColumnCount(); j++) {
    				if (tableStundenplan.getModel().getValueAt(i, j) != null) {
    				    out.write(tableStundenplan.getModel().getValueAt(i, j).toString());
    				} else {
    				    out.write("");
    				}
    				out.newLine();
    			    }
    			}
    		    } catch (IOException e1) {
			// TODO Auto-generated catch block
			e1.printStackTrace();
		    }
    		}
    	});
	setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
	setBounds(100, 100, 450, 300);
	contentPane = new JPanel();
	contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
	setContentPane(contentPane);
	contentPane.setLayout(new MigLayout("", "[grow][]", "[grow][]"));
	
	JScrollPane scrollPane = new JScrollPane();
	contentPane.add(scrollPane, "cell 0 0,grow");
	
	tableStundenplan = new JTable();
	stundenplanModel = new DefaultTableModel(
		new String[][] {
	    {"1, null, null, null, null, null"}, 
	    {"2, null, null, null, null, null"}, 
	    {"3, null, null, null, null, null"}, 
	    {"4, null, null, null, null, null"}, 
	    {"5, null, null, null, null, null"}, 
	    {"6, null, null, null, null, null"}, 
	    {"7, null, null, null, null, null"}, 
	    {"8, null, null, null, null, null"}, 
	    {"9, null, null, null, null, null"}, 
	    {"10, null, null, null, null, null"}
	    }, 
		new String[] {
			"Stunde", "Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag"
			}
	    );
	scrollPane.setViewportView(tableStundenplan);
	tableStundenplan.setModel(stundenplanModel);
    }

}
